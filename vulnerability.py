import requests
import json

def check_vulnerabilities(package_name, version):
    url = "https://api.osv.dev/v1/query"
    headers = {"Content-Type": "application/json"}
    payload = {
        "package": {
            "name": package_name,
            "ecosystem": "PyPI"
        },
        "version": version
    }

    response = requests.post(url, headers=headers, json=payload)

    if response.status_code != 200:
        print(f"Error: {response.status_code} - {response.text}")
        return

    data = response.json()
    vulns = data.get("vulns", [])

    if not vulns:
        print(f"No known vulnerabilities found for {package_name}=={version}.")
    else:
        print(f"âš  Found {len(vulns)} vulnerabilities for {package_name}=={version}:\n")
        for v in vulns:
            print(f"ID: {v.get('id')}")
            print(f"Summary: {v.get('summary', 'N/A')}")
            print(f"Affected Range: {v['affected'][0].get('ranges')[0].get('events')}")
            print(f"Details: {v.get('details', 'N/A')}")
            print(f"More info: {v.get('references', [{}])[0].get('url', 'N/A')}\n")
            print("-" * 60)

# Example usage
if __name__ == "__main__":
    pkg = input("Enter PyPI package name: ").strip()
    ver = input(f"Enter version of {pkg}: ").strip()
    check_vulnerabilities(pkg, ver)
